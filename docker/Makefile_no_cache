COMPLETE_EDITION=1

platforms=win mac lin
container=blufx-cross-compile-env

all: mac win lin

.image: Dockerfile build.sh
	docker build . -t $(container) --no-cache
	docker inspect -f "{{ .ID}}" $(container):latest > .image

bash: .image
	docker run -it --rm -v "$(realpath ../src):/src" --entrypoint bash $(container):latest

$(platforms): .image
	docker run -i --rm -v "$(realpath ../src):/src" $(container):latest --complete $(COMPLETE_EDITION) $@

.PHONY: $(platforms) bash
